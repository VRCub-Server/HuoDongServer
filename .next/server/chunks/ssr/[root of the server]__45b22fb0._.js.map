{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/loading-link.tsx/proxy.mjs"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/src/components/loading-link.tsx <module evaluation> from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/loading-link.tsx <module evaluation>\",\n    \"default\",\n);\n"],"names":[],"mappings":";;;AAAA;;uCACe,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EACjC;IAAa,MAAM,IAAI,MAAM;AAAmS,GAChU,iEACA","debugId":null}},
    {"offset": {"line": 21, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/loading-link.tsx/proxy.mjs"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/src/components/loading-link.tsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/loading-link.tsx\",\n    \"default\",\n);\n"],"names":[],"mappings":";;;AAAA;;uCACe,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EACjC;IAAa,MAAM,IAAI,MAAM;AAA+Q,GAC5S,6CACA","debugId":null}},
    {"offset": {"line": 35, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 45, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/lib/utils.ts"],"sourcesContent":["import { clsx, type ClassValue } from \"clsx\"\nimport { twMerge } from \"tailwind-merge\"\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n"],"names":[],"mappings":";;;AAAA;AACA;;;AAEO,SAAS,GAAG,GAAG,MAAoB;IACxC,OAAO,CAAA,GAAA,2JAAA,CAAA,UAAO,AAAD,EAAE,CAAA,GAAA,qIAAA,CAAA,OAAI,AAAD,EAAE;AACtB","debugId":null}},
    {"offset": {"line": 61, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/button.tsx"],"sourcesContent":["import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-primary text-primary-foreground hover:bg-primary/90\",\n        destructive:\n          \"bg-destructive text-destructive-foreground hover:bg-destructive/90\",\n        outline:\n          \"border border-input bg-background hover:bg-accent hover:text-accent-foreground\",\n        secondary:\n          \"bg-secondary text-secondary-foreground hover:bg-secondary/80\",\n        ghost: \"hover:bg-accent hover:text-accent-foreground\",\n        link: \"text-primary underline-offset-4 hover:underline\",\n      },\n      size: {\n        default: \"h-10 px-4 py-2\",\n        sm: \"h-9 rounded-md px-3\",\n        lg: \"h-11 rounded-md px-8\",\n        icon: \"h-10 w-10\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nexport interface ButtonProps\n  extends React.ButtonHTMLAttributes<HTMLButtonElement>,\n    VariantProps<typeof buttonVariants> {\n  asChild?: boolean\n}\n\nconst Button = React.forwardRef<HTMLButtonElement, ButtonProps>(\n  ({ className, variant, size, asChild = false, ...props }, ref) => {\n    const Comp = asChild ? Slot : \"button\"\n    return (\n      <Comp\n        className={cn(buttonVariants({ variant, size, className }))}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nButton.displayName = \"Button\"\n\nexport { Button, buttonVariants }\n"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;AAEA;;;;;;AAEA,MAAM,iBAAiB,CAAA,GAAA,gKAAA,CAAA,MAAG,AAAD,EACvB,4VACA;IACE,UAAU;QACR,SAAS;YACP,SAAS;YACT,aACE;YACF,SACE;YACF,WACE;YACF,OAAO;YACP,MAAM;QACR;QACA,MAAM;YACJ,SAAS;YACT,IAAI;YACJ,IAAI;YACJ,MAAM;QACR;IACF;IACA,iBAAiB;QACf,SAAS;QACT,MAAM;IACR;AACF;AASF,MAAM,uBAAS,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAC5B,CAAC,EAAE,SAAS,EAAE,OAAO,EAAE,IAAI,EAAE,UAAU,KAAK,EAAE,GAAG,OAAO,EAAE;IACxD,MAAM,OAAO,UAAU,gKAAA,CAAA,OAAI,GAAG;IAC9B,qBACE,8OAAC;QACC,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,eAAe;YAAE;YAAS;YAAM;QAAU;QACxD,KAAK;QACJ,GAAG,KAAK;;;;;;AAGf;AAEF,OAAO,WAAW,GAAG","debugId":null}},
    {"offset": {"line": 121, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/avatar.tsx/proxy.mjs"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport const Avatar = registerClientReference(\n    function() { throw new Error(\"Attempted to call Avatar() from the server but Avatar is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/ui/avatar.tsx <module evaluation>\",\n    \"Avatar\",\n);\nexport const AvatarFallback = registerClientReference(\n    function() { throw new Error(\"Attempted to call AvatarFallback() from the server but AvatarFallback is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/ui/avatar.tsx <module evaluation>\",\n    \"AvatarFallback\",\n);\nexport const AvatarImage = registerClientReference(\n    function() { throw new Error(\"Attempted to call AvatarImage() from the server but AvatarImage is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/ui/avatar.tsx <module evaluation>\",\n    \"AvatarImage\",\n);\n"],"names":[],"mappings":";;;;;AAAA;;AACO,MAAM,SAAS,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EACxC;IAAa,MAAM,IAAI,MAAM;AAA4N,GACzP,8DACA;AAEG,MAAM,iBAAiB,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EAChD;IAAa,MAAM,IAAI,MAAM;AAA4O,GACzQ,8DACA;AAEG,MAAM,cAAc,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EAC7C;IAAa,MAAM,IAAI,MAAM;AAAsO,GACnQ,8DACA","debugId":null}},
    {"offset": {"line": 143, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/avatar.tsx/proxy.mjs"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport const Avatar = registerClientReference(\n    function() { throw new Error(\"Attempted to call Avatar() from the server but Avatar is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/ui/avatar.tsx\",\n    \"Avatar\",\n);\nexport const AvatarFallback = registerClientReference(\n    function() { throw new Error(\"Attempted to call AvatarFallback() from the server but AvatarFallback is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/ui/avatar.tsx\",\n    \"AvatarFallback\",\n);\nexport const AvatarImage = registerClientReference(\n    function() { throw new Error(\"Attempted to call AvatarImage() from the server but AvatarImage is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/ui/avatar.tsx\",\n    \"AvatarImage\",\n);\n"],"names":[],"mappings":";;;;;AAAA;;AACO,MAAM,SAAS,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EACxC;IAAa,MAAM,IAAI,MAAM;AAA4N,GACzP,0CACA;AAEG,MAAM,iBAAiB,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EAChD;IAAa,MAAM,IAAI,MAAM;AAA4O,GACzQ,0CACA;AAEG,MAAM,cAAc,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EAC7C;IAAa,MAAM,IAAI,MAAM;AAAsO,GACnQ,0CACA","debugId":null}},
    {"offset": {"line": 165, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 175, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/dropdown-menu.tsx/proxy.mjs"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport const DropdownMenu = registerClientReference(\n    function() { throw new Error(\"Attempted to call DropdownMenu() from the server but DropdownMenu is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/ui/dropdown-menu.tsx <module evaluation>\",\n    \"DropdownMenu\",\n);\nexport const DropdownMenuCheckboxItem = registerClientReference(\n    function() { throw new Error(\"Attempted to call DropdownMenuCheckboxItem() from the server but DropdownMenuCheckboxItem is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/ui/dropdown-menu.tsx <module evaluation>\",\n    \"DropdownMenuCheckboxItem\",\n);\nexport const DropdownMenuContent = registerClientReference(\n    function() { throw new Error(\"Attempted to call DropdownMenuContent() from the server but DropdownMenuContent is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/ui/dropdown-menu.tsx <module evaluation>\",\n    \"DropdownMenuContent\",\n);\nexport const DropdownMenuGroup = registerClientReference(\n    function() { throw new Error(\"Attempted to call DropdownMenuGroup() from the server but DropdownMenuGroup is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/ui/dropdown-menu.tsx <module evaluation>\",\n    \"DropdownMenuGroup\",\n);\nexport const DropdownMenuItem = registerClientReference(\n    function() { throw new Error(\"Attempted to call DropdownMenuItem() from the server but DropdownMenuItem is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/ui/dropdown-menu.tsx <module evaluation>\",\n    \"DropdownMenuItem\",\n);\nexport const DropdownMenuLabel = registerClientReference(\n    function() { throw new Error(\"Attempted to call DropdownMenuLabel() from the server but DropdownMenuLabel is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/ui/dropdown-menu.tsx <module evaluation>\",\n    \"DropdownMenuLabel\",\n);\nexport const DropdownMenuPortal = registerClientReference(\n    function() { throw new Error(\"Attempted to call DropdownMenuPortal() from the server but DropdownMenuPortal is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/ui/dropdown-menu.tsx <module evaluation>\",\n    \"DropdownMenuPortal\",\n);\nexport const DropdownMenuRadioGroup = registerClientReference(\n    function() { throw new Error(\"Attempted to call DropdownMenuRadioGroup() from the server but DropdownMenuRadioGroup is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/ui/dropdown-menu.tsx <module evaluation>\",\n    \"DropdownMenuRadioGroup\",\n);\nexport const DropdownMenuRadioItem = registerClientReference(\n    function() { throw new Error(\"Attempted to call DropdownMenuRadioItem() from the server but DropdownMenuRadioItem is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/ui/dropdown-menu.tsx <module evaluation>\",\n    \"DropdownMenuRadioItem\",\n);\nexport const DropdownMenuSeparator = registerClientReference(\n    function() { throw new Error(\"Attempted to call DropdownMenuSeparator() from the server but DropdownMenuSeparator is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/ui/dropdown-menu.tsx <module evaluation>\",\n    \"DropdownMenuSeparator\",\n);\nexport const DropdownMenuShortcut = registerClientReference(\n    function() { throw new Error(\"Attempted to call DropdownMenuShortcut() from the server but DropdownMenuShortcut is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/ui/dropdown-menu.tsx <module evaluation>\",\n    \"DropdownMenuShortcut\",\n);\nexport const DropdownMenuSub = registerClientReference(\n    function() { throw new Error(\"Attempted to call DropdownMenuSub() from the server but DropdownMenuSub is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/ui/dropdown-menu.tsx <module evaluation>\",\n    \"DropdownMenuSub\",\n);\nexport const DropdownMenuSubContent = registerClientReference(\n    function() { throw new Error(\"Attempted to call DropdownMenuSubContent() from the server but DropdownMenuSubContent is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/ui/dropdown-menu.tsx <module evaluation>\",\n    \"DropdownMenuSubContent\",\n);\nexport const DropdownMenuSubTrigger = registerClientReference(\n    function() { throw new Error(\"Attempted to call DropdownMenuSubTrigger() from the server but DropdownMenuSubTrigger is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/ui/dropdown-menu.tsx <module evaluation>\",\n    \"DropdownMenuSubTrigger\",\n);\nexport const DropdownMenuTrigger = registerClientReference(\n    function() { throw new Error(\"Attempted to call DropdownMenuTrigger() from the server but DropdownMenuTrigger is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/ui/dropdown-menu.tsx <module evaluation>\",\n    \"DropdownMenuTrigger\",\n);\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AAAA;;AACO,MAAM,eAAe,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EAC9C;IAAa,MAAM,IAAI,MAAM;AAAwO,GACrQ,qEACA;AAEG,MAAM,2BAA2B,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EAC1D;IAAa,MAAM,IAAI,MAAM;AAAgQ,GAC7R,qEACA;AAEG,MAAM,sBAAsB,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EACrD;IAAa,MAAM,IAAI,MAAM;AAAsP,GACnR,qEACA;AAEG,MAAM,oBAAoB,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EACnD;IAAa,MAAM,IAAI,MAAM;AAAkP,GAC/Q,qEACA;AAEG,MAAM,mBAAmB,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EAClD;IAAa,MAAM,IAAI,MAAM;AAAgP,GAC7Q,qEACA;AAEG,MAAM,oBAAoB,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EACnD;IAAa,MAAM,IAAI,MAAM;AAAkP,GAC/Q,qEACA;AAEG,MAAM,qBAAqB,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EACpD;IAAa,MAAM,IAAI,MAAM;AAAoP,GACjR,qEACA;AAEG,MAAM,yBAAyB,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EACxD;IAAa,MAAM,IAAI,MAAM;AAA4P,GACzR,qEACA;AAEG,MAAM,wBAAwB,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EACvD;IAAa,MAAM,IAAI,MAAM;AAA0P,GACvR,qEACA;AAEG,MAAM,wBAAwB,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EACvD;IAAa,MAAM,IAAI,MAAM;AAA0P,GACvR,qEACA;AAEG,MAAM,uBAAuB,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EACtD;IAAa,MAAM,IAAI,MAAM;AAAwP,GACrR,qEACA;AAEG,MAAM,kBAAkB,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EACjD;IAAa,MAAM,IAAI,MAAM;AAA8O,GAC3Q,qEACA;AAEG,MAAM,yBAAyB,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EACxD;IAAa,MAAM,IAAI,MAAM;AAA4P,GACzR,qEACA;AAEG,MAAM,yBAAyB,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EACxD;IAAa,MAAM,IAAI,MAAM;AAA4P,GACzR,qEACA;AAEG,MAAM,sBAAsB,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EACrD;IAAa,MAAM,IAAI,MAAM;AAAsP,GACnR,qEACA","debugId":null}},
    {"offset": {"line": 245, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/dropdown-menu.tsx/proxy.mjs"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport const DropdownMenu = registerClientReference(\n    function() { throw new Error(\"Attempted to call DropdownMenu() from the server but DropdownMenu is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/ui/dropdown-menu.tsx\",\n    \"DropdownMenu\",\n);\nexport const DropdownMenuCheckboxItem = registerClientReference(\n    function() { throw new Error(\"Attempted to call DropdownMenuCheckboxItem() from the server but DropdownMenuCheckboxItem is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/ui/dropdown-menu.tsx\",\n    \"DropdownMenuCheckboxItem\",\n);\nexport const DropdownMenuContent = registerClientReference(\n    function() { throw new Error(\"Attempted to call DropdownMenuContent() from the server but DropdownMenuContent is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/ui/dropdown-menu.tsx\",\n    \"DropdownMenuContent\",\n);\nexport const DropdownMenuGroup = registerClientReference(\n    function() { throw new Error(\"Attempted to call DropdownMenuGroup() from the server but DropdownMenuGroup is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/ui/dropdown-menu.tsx\",\n    \"DropdownMenuGroup\",\n);\nexport const DropdownMenuItem = registerClientReference(\n    function() { throw new Error(\"Attempted to call DropdownMenuItem() from the server but DropdownMenuItem is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/ui/dropdown-menu.tsx\",\n    \"DropdownMenuItem\",\n);\nexport const DropdownMenuLabel = registerClientReference(\n    function() { throw new Error(\"Attempted to call DropdownMenuLabel() from the server but DropdownMenuLabel is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/ui/dropdown-menu.tsx\",\n    \"DropdownMenuLabel\",\n);\nexport const DropdownMenuPortal = registerClientReference(\n    function() { throw new Error(\"Attempted to call DropdownMenuPortal() from the server but DropdownMenuPortal is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/ui/dropdown-menu.tsx\",\n    \"DropdownMenuPortal\",\n);\nexport const DropdownMenuRadioGroup = registerClientReference(\n    function() { throw new Error(\"Attempted to call DropdownMenuRadioGroup() from the server but DropdownMenuRadioGroup is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/ui/dropdown-menu.tsx\",\n    \"DropdownMenuRadioGroup\",\n);\nexport const DropdownMenuRadioItem = registerClientReference(\n    function() { throw new Error(\"Attempted to call DropdownMenuRadioItem() from the server but DropdownMenuRadioItem is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/ui/dropdown-menu.tsx\",\n    \"DropdownMenuRadioItem\",\n);\nexport const DropdownMenuSeparator = registerClientReference(\n    function() { throw new Error(\"Attempted to call DropdownMenuSeparator() from the server but DropdownMenuSeparator is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/ui/dropdown-menu.tsx\",\n    \"DropdownMenuSeparator\",\n);\nexport const DropdownMenuShortcut = registerClientReference(\n    function() { throw new Error(\"Attempted to call DropdownMenuShortcut() from the server but DropdownMenuShortcut is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/ui/dropdown-menu.tsx\",\n    \"DropdownMenuShortcut\",\n);\nexport const DropdownMenuSub = registerClientReference(\n    function() { throw new Error(\"Attempted to call DropdownMenuSub() from the server but DropdownMenuSub is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/ui/dropdown-menu.tsx\",\n    \"DropdownMenuSub\",\n);\nexport const DropdownMenuSubContent = registerClientReference(\n    function() { throw new Error(\"Attempted to call DropdownMenuSubContent() from the server but DropdownMenuSubContent is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/ui/dropdown-menu.tsx\",\n    \"DropdownMenuSubContent\",\n);\nexport const DropdownMenuSubTrigger = registerClientReference(\n    function() { throw new Error(\"Attempted to call DropdownMenuSubTrigger() from the server but DropdownMenuSubTrigger is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/ui/dropdown-menu.tsx\",\n    \"DropdownMenuSubTrigger\",\n);\nexport const DropdownMenuTrigger = registerClientReference(\n    function() { throw new Error(\"Attempted to call DropdownMenuTrigger() from the server but DropdownMenuTrigger is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/ui/dropdown-menu.tsx\",\n    \"DropdownMenuTrigger\",\n);\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AAAA;;AACO,MAAM,eAAe,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EAC9C;IAAa,MAAM,IAAI,MAAM;AAAwO,GACrQ,iDACA;AAEG,MAAM,2BAA2B,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EAC1D;IAAa,MAAM,IAAI,MAAM;AAAgQ,GAC7R,iDACA;AAEG,MAAM,sBAAsB,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EACrD;IAAa,MAAM,IAAI,MAAM;AAAsP,GACnR,iDACA;AAEG,MAAM,oBAAoB,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EACnD;IAAa,MAAM,IAAI,MAAM;AAAkP,GAC/Q,iDACA;AAEG,MAAM,mBAAmB,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EAClD;IAAa,MAAM,IAAI,MAAM;AAAgP,GAC7Q,iDACA;AAEG,MAAM,oBAAoB,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EACnD;IAAa,MAAM,IAAI,MAAM;AAAkP,GAC/Q,iDACA;AAEG,MAAM,qBAAqB,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EACpD;IAAa,MAAM,IAAI,MAAM;AAAoP,GACjR,iDACA;AAEG,MAAM,yBAAyB,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EACxD;IAAa,MAAM,IAAI,MAAM;AAA4P,GACzR,iDACA;AAEG,MAAM,wBAAwB,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EACvD;IAAa,MAAM,IAAI,MAAM;AAA0P,GACvR,iDACA;AAEG,MAAM,wBAAwB,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EACvD;IAAa,MAAM,IAAI,MAAM;AAA0P,GACvR,iDACA;AAEG,MAAM,uBAAuB,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EACtD;IAAa,MAAM,IAAI,MAAM;AAAwP,GACrR,iDACA;AAEG,MAAM,kBAAkB,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EACjD;IAAa,MAAM,IAAI,MAAM;AAA8O,GAC3Q,iDACA;AAEG,MAAM,yBAAyB,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EACxD;IAAa,MAAM,IAAI,MAAM;AAA4P,GACzR,iDACA;AAEG,MAAM,yBAAyB,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EACxD;IAAa,MAAM,IAAI,MAAM;AAA4P,GACzR,iDACA;AAEG,MAAM,sBAAsB,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EACrD;IAAa,MAAM,IAAI,MAAM;AAAsP,GACnR,iDACA","debugId":null}},
    {"offset": {"line": 315, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 333, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/lib/data.ts"],"sourcesContent":["\nimport fs from 'fs/promises';\nimport path from 'path';\nimport type { Event, User, Participant, Announcement } from './types';\nimport { parseISO } from 'date-fns';\n\nconst DATA_DIR = path.join(process.cwd(), 'data');\nconst USERS_FILE = path.join(DATA_DIR, 'users.json');\nconst EVENTS_FILE = path.join(DATA_DIR, 'events.json');\nconst ABOUT_USER_FILE = path.join(DATA_DIR, 'about-user.json');\n\nconst defaultUsers: User[] = [\n    { id: 'Steve', username: 'Steve', avatarUrl: `https://placehold.co/100x100.png?text=St`, joinedEventIds: ['event1', 'event2'], op: 0, password: '123456' },\n    { id: 'Alex', username: 'Alex', avatarUrl: `https://placehold.co/100x100.png?text=Al`, joinedEventIds: ['event2'], op: 0, password: '123456' },\n    { id: 'Notch', username: 'Notch', avatarUrl: `https://placehold.co/100x100.png?text=No`, joinedEventIds: [], op: 1, password: '123456' },\n    { id: 'dream_pep_id', username: 'dream_pep', avatarUrl: `https://placehold.co/100x100.png?text=dr`, joinedEventIds: ['event1', 'event3'], op: 1, password: '123456' }\n];\n\nconst defaultEvents: Event[] = [\n    {\n        id: 'event1', name: '生存游戏锦标赛', date: '2024-07-29T12:00:00.000Z',\n        description: \"\\n### 欢迎参加年度生存游戏！\\n证明你的勇气，成为最后的幸存者。\\n**规则：**\\n- 禁止作弊\\n- 联盟是暂时的\\n- 玩得开心！\\n**奖品：**\\n- 第一名：钻石奖杯\\n- 第二名：金锭\\n- 第三名：铁制工具\\n\",\n        participantLimit: 24,\n        participants: [\n             { id: 'Steve', username: 'Steve', avatarUrl: `https://placehold.co/100x100.png?text=St`, isCheckedIn: false, op: 0, password: '123456' },\n             { id: 'dream_pep_id', username: 'dream_pep', avatarUrl: `https://placehold.co/100x100.png?text=dr`, isCheckedIn: false, op: 1, password: '123456' }\n        ],\n        cdKey: 'SURVIVAL2024', imageUrl: `https://placehold.co/800x400.png`, organizerId: 'Notch',\n    },\n    {\n        id: 'event2', name: '创意建筑大赛', date: '2024-07-22T12:00:00.000Z',\n        description: \"\\n## 展示你的建筑技巧！\\n主题：**中世纪城堡**\\n在时限内建造最令人印象深刻的城堡。\\n评分标准：\\n- 创意\\n- 细节\\n- 规模\\n\",\n        participantLimit: 50,\n        participants: [\n            { id: 'Steve', username: 'Steve', avatarUrl: `https://placehold.co/100x100.png?text=St`, isCheckedIn: true, op: 0, password: '123456' },\n            { id: 'Alex', username: 'Alex', avatarUrl: `https://placehold.co/100x100.png?text=Al`, isCheckedIn: false, op: 0, password: '123456' },\n        ],\n        cdKey: 'BUILDMC2024', imageUrl: `https://placehold.co/800x400.png`, organizerId: 'Notch',\n    },\n    {\n        id: 'event3', name: '跑酷挑战赛', date: '2024-07-08T12:00:00.000Z',\n        description: '在我们迄今为止最难的跑酷地图中测试你的敏捷性。完成即可获得奖励！',\n        participants: [ { id: 'dream_pep_id', username: 'dream_pep', avatarUrl: `https://placehold.co/100x100.png?text=dr`, isCheckedIn: true, op: 1, password: '123456' } ],\n        cdKey: 'PARKOURX', imageUrl: `https://placehold.co/800x400.png`, organizerId: 'Notch',\n    },\n     {\n        id: 'event4', name: '红石装置展览会', date: '2024-08-21T12:00:00.000Z',\n        description: '展示你最巧妙的红石发明。创新是关键！', participantLimit: 10, participants: [],\n        cdKey: 'REDSTONEFAI', imageUrl: `https://placehold.co/800x400.png`, organizerId: 'Notch',\n    },\n];\n\nconst defaultAnnouncements: Announcement[] = [\n  { id: 'announce1', title: '欢迎来到 MineVent!', content: '发现、加入并创建精彩的《我的世界》活动。祝您玩得愉快！', date: new Date().toISOString() },\n  { id: 'announce2', title: '新功能：仪表盘公告', content: '现在您可以在仪表盘查阅最新公告了。', date: new Date(Date.now() - 86400000).toISOString() }, // Approx. 1 day ago\n];\n\n\nasync function initializeFile<T>(filePath: string, defaultContent: T[], fileNameForLog: string): Promise<T[]> {\n  try {\n    await fs.access(DATA_DIR);\n  } catch (error) {\n    try {\n      await fs.mkdir(DATA_DIR, { recursive: true });\n    } catch (mkdirError) {\n      console.error(`CRITICAL: Failed to create data directory ${DATA_DIR} for ${fileNameForLog}. Returning in-memory defaults.`, mkdirError);\n      return defaultContent.map(item => ({...item}));\n    }\n  }\n\n  try {\n    const fileContent = await fs.readFile(filePath, 'utf-8');\n    const data = JSON.parse(fileContent);\n    if (!Array.isArray(data) || (Array.isArray(data) && data.length === 0 && defaultContent.length > 0)) {\n      console.warn(`${fileNameForLog} is empty or not a valid array. Attempting to initialize with default data.`);\n      try {\n        await fs.writeFile(filePath, JSON.stringify(defaultContent, null, 2), 'utf-8');\n      } catch (writeError) {\n        console.error(`CRITICAL: Failed to write ${fileNameForLog} during initialization. Proceeding with in-memory defaults. Error: ${writeError instanceof Error ? writeError.message : String(writeError)}`);\n        return defaultContent.map(item => ({...item}));\n      }\n      return defaultContent.map(item => ({...item}));\n    }\n    return data.map((item: any) => ({...item}));\n  } catch (error) {\n    console.warn(`Error reading/parsing ${fileNameForLog}, or file not found. Attempting to initialize with default data. Error: ${error instanceof Error ? error.message : String(error)}`);\n    try {\n      await fs.writeFile(filePath, JSON.stringify(defaultContent, null, 2), 'utf-8');\n    } catch (writeError) {\n      console.error(`CRITICAL: Failed to write ${fileNameForLog} during recovery initialization. Proceeding with in-memory defaults. Error: ${writeError instanceof Error ? writeError.message : String(writeError)}`);\n      return defaultContent.map(item => ({...item}));\n    }\n    return defaultContent.map(item => ({...item}));\n  }\n}\n\nasync function initializeUsersFile(): Promise<User[]> {\n  const filePath = USERS_FILE;\n  const fileNameForLog = 'users.json';\n  let usersFromFile: User[] = [];\n  let needsWrite = false;\n\n  try {\n    await fs.access(DATA_DIR);\n  } catch (error) {\n    try {\n      await fs.mkdir(DATA_DIR, { recursive: true });\n    } catch (mkdirError) {\n        console.error(`CRITICAL: Failed to create data directory ${DATA_DIR}. Returning in-memory default users.`, mkdirError);\n        return defaultUsers.map(u => ({...u}));\n    }\n    console.warn(`${fileNameForLog} not found (data directory created). Initializing with default users.`);\n    usersFromFile = defaultUsers.map(u => ({...u}));\n    needsWrite = true;\n  }\n\n  if (!needsWrite) {\n    try {\n      const fileContent = await fs.readFile(filePath, 'utf-8');\n      const parsedData = JSON.parse(fileContent);\n\n      if (!Array.isArray(parsedData)) {\n        console.warn(`${fileNameForLog} content is not a valid array. Initializing with default users.`);\n        usersFromFile = defaultUsers.map(u => ({...u}));\n        needsWrite = true;\n      } else if (parsedData.length === 0 && defaultUsers.length > 0) {\n        console.warn(`${fileNameForLog} was an empty array. Initializing with default users.`);\n        usersFromFile = defaultUsers.map(u => ({...u}));\n        needsWrite = true;\n      } else {\n        usersFromFile = parsedData.map((u: any) => ({...u}));\n        defaultUsers.forEach(defaultUser => {\n          if (!usersFromFile.some(u => u.id === defaultUser.id)) {\n            console.warn(`Default user ${defaultUser.username} (ID: ${defaultUser.id}) missing from ${fileNameForLog}. Adding.`);\n            usersFromFile.push({...defaultUser});\n            needsWrite = true;\n          }\n        });\n        usersFromFile.forEach(user => {\n          let userModified = false;\n          if (user.op === undefined) { user.op = 0; userModified = true; }\n          if (!Array.isArray(user.joinedEventIds)) { user.joinedEventIds = []; userModified = true; }\n          if (!user.avatarUrl && user.username) {\n             user.avatarUrl = `https://placehold.co/100x100.png?text=${user.username.substring(0, 2).toUpperCase()}`;\n             userModified = true;\n          }\n          if (user.password === undefined) {\n             const defaultRefUser = defaultUsers.find(du => du.id === user.id);\n             user.password = defaultRefUser?.password || '123456'; // Fallback password\n             userModified = true;\n          }\n          if (userModified) {\n            needsWrite = true;\n          }\n        });\n      }\n    } catch (error) {\n      console.warn(`Error reading/parsing ${fileNameForLog}, or file not found. Initializing with default users. Error: ${error instanceof Error ? error.message : String(error)}`);\n      usersFromFile = defaultUsers.map(u => ({...u}));\n      needsWrite = true;\n    }\n  }\n\n  if (needsWrite) {\n    try {\n      await fs.writeFile(filePath, JSON.stringify(usersFromFile, null, 2), 'utf-8');\n    } catch (writeError) {\n      console.error(`CRITICAL: Failed to write ${fileNameForLog} during initialization/update. Proceeding with in-memory version. Error: ${writeError instanceof Error ? writeError.message : String(writeError)}`);\n    }\n  }\n  return usersFromFile.map(u => ({...u}));\n}\n\n\nlet usersCache: User[] | null = null;\nlet eventsCache: Event[] | null = null;\nlet announcementsCache: Announcement[] | null = null;\nlet lastUsersReadTime = 0;\nlet lastEventsReadTime = 0;\nlet lastAnnouncementsReadTime = 0;\nconst CACHE_DURATION = 500; // Reduced for more frequent checks during dev\n\nasync function ensureDataFilesInitialized() {\n    const currentTime = Date.now();\n\n    try {\n        if (!usersCache || (currentTime - lastUsersReadTime > CACHE_DURATION)) {\n            usersCache = await initializeUsersFile();\n            lastUsersReadTime = currentTime;\n        }\n    } catch (e) {\n        console.error(\"CRITICAL: Error during initializeUsersFile. Falling back to default users for cache.\", e);\n        usersCache = defaultUsers.map(u => ({...u}));\n        lastUsersReadTime = currentTime;\n    }\n\n    try {\n        if (!eventsCache || (currentTime - lastEventsReadTime > CACHE_DURATION)) {\n            eventsCache = await initializeFile<Event>(EVENTS_FILE, defaultEvents, 'events.json');\n            lastEventsReadTime = currentTime;\n        }\n    } catch (e) {\n        console.error(\"CRITICAL: Error during initializeFile for events. Falling back to default events for cache.\", e);\n        eventsCache = defaultEvents.map(ev => ({...ev}));\n        lastEventsReadTime = currentTime;\n    }\n\n    try {\n        if (!announcementsCache || (currentTime - lastAnnouncementsReadTime > CACHE_DURATION)) {\n            announcementsCache = await initializeFile<Announcement>(ABOUT_USER_FILE, defaultAnnouncements, 'about-user.json');\n            lastAnnouncementsReadTime = currentTime;\n        }\n    } catch (e) {\n        console.error(\"CRITICAL: Error during initializeFile for announcements. Falling back to default announcements for cache.\", e);\n        announcementsCache = defaultAnnouncements.map(a => ({...a}));\n        lastAnnouncementsReadTime = currentTime;\n    }\n}\n\n\nasync function readData<T>(filePath: string): Promise<T[]> {\n  await ensureDataFilesInitialized(); \n\n  if (filePath === USERS_FILE && usersCache) return usersCache.map(u => ({...u})) as T[];\n  if (filePath === EVENTS_FILE && eventsCache) return eventsCache.map(e => ({...e})) as T[];\n  if (filePath === ABOUT_USER_FILE && announcementsCache) return announcementsCache.map(a => ({...a})) as T[];\n\n  console.warn(`Cache miss for ${filePath} after ensureDataFilesInitialized. Reading directly as fallback.`);\n  try {\n    const jsonData = await fs.readFile(filePath, 'utf-8');\n    const data = JSON.parse(jsonData);\n    if (!Array.isArray(data)) {\n        console.warn(`Data in ${filePath} is not an array. Returning appropriate default.`);\n        if (filePath === USERS_FILE) return defaultUsers.map(u => ({...u})) as T[];\n        if (filePath === EVENTS_FILE) return defaultEvents.map(e => ({...e})) as T[];\n        if (filePath === ABOUT_USER_FILE) return defaultAnnouncements.map(a => ({...a})) as T[];\n        return [];\n    }\n    return data.map((item: any) => ({...item}));\n  } catch (error: any) {\n    console.error(`CRITICAL: Unexpected error reading data from ${filePath} during direct read fallback:`, error);\n    if (filePath === USERS_FILE) return defaultUsers.map(u => ({...u})) as T[];\n    if (filePath === EVENTS_FILE) return defaultEvents.map(e => ({...e})) as T[];\n    if (filePath === ABOUT_USER_FILE) return defaultAnnouncements.map(a => ({...a})) as T[];\n    return [];\n  }\n}\n\nasync function writeData<T>(filePath: string, data: T[]): Promise<void> {\n  try {\n    await fs.access(DATA_DIR);\n  } catch (error) {\n    try {\n      await fs.mkdir(DATA_DIR, { recursive: true });\n    } catch (mkdirError) {\n      console.error(`CRITICAL: Failed to create data directory ${DATA_DIR} during write for ${filePath}.`, mkdirError);\n      throw mkdirError;\n    }\n  }\n\n  try {\n    const jsonData = JSON.stringify(data, null, 2);\n    await fs.writeFile(filePath, jsonData, 'utf-8');\n    const currentTime = Date.now();\n    if (filePath === USERS_FILE) { usersCache = data.map(u => ({...(u as any)})); lastUsersReadTime = currentTime; }\n    if (filePath === EVENTS_FILE) { eventsCache = data.map(e => ({...(e as any)})); lastEventsReadTime = currentTime; }\n    if (filePath === ABOUT_USER_FILE) { announcementsCache = data.map(a => ({...(a as any)})); lastAnnouncementsReadTime = currentTime; }\n  } catch (error) {\n    console.error(`写入数据错误 ${filePath}:`, error);\n    throw error;\n  }\n}\n\n// --- Event Functions ---\nexport async function getEvents(): Promise<Event[]> {\n  return readData<Event>(EVENTS_FILE);\n}\n\nexport async function getEventById(id: string): Promise<Event | undefined> {\n  const events = await readData<Event>(EVENTS_FILE);\n  return events.find(e => e.id === id);\n}\n\nexport async function getEventByCdKey(cdKey: string): Promise<Event | undefined> {\n  const events = await readData<Event>(EVENTS_FILE);\n  return events.find(e => e.cdKey.toLowerCase() === cdKey.toLowerCase());\n}\n\nexport async function createEvent(eventData: Omit<Event, 'id' | 'participants' | 'organizerId'>, organizerId: string): Promise<Event> {\n  const events = await readData<Event>(EVENTS_FILE);\n  const newEvent: Event = {\n    ...eventData,\n    id: `event_${Date.now()}_${Math.random().toString(36).substring(2, 7)}`,\n    participants: [],\n    organizerId,\n  };\n  events.push(newEvent);\n  await writeData<Event>(EVENTS_FILE, events);\n  return {...newEvent};\n}\n\nexport async function updateEventById(eventId: string, eventData: Partial<Omit<Event, 'id' | 'participants' | 'organizerId'>>): Promise<Event | null> {\n  let events = await readData<Event>(EVENTS_FILE);\n  const eventIndex = events.findIndex(e => e.id === eventId);\n  if (eventIndex === -1) {\n    return null;\n  }\n  // Only update allowed fields, preserve participants, id, organizerId\n  events[eventIndex] = {\n    ...events[eventIndex],\n    ...eventData,\n    id: events[eventIndex].id, // ensure id is not changed\n    participants: events[eventIndex].participants, // ensure participants are not changed\n    organizerId: events[eventIndex].organizerId, // ensure organizerId is not changed\n  };\n  await writeData<Event>(EVENTS_FILE, events);\n  return {...events[eventIndex]};\n}\n\nexport async function deleteEventById(eventId: string): Promise<{ success: boolean, message: string }> {\n  let events = await readData<Event>(EVENTS_FILE);\n  const initialEventCount = events.length;\n  events = events.filter(e => e.id !== eventId);\n\n  if (events.length === initialEventCount) {\n    return { success: false, message: \"活动未找到，无法删除。\" };\n  }\n\n  await writeData<Event>(EVENTS_FILE, events);\n\n  // Remove this eventId from all users' joinedEventIds\n  let users = await readData<User>(USERS_FILE);\n  users = users.map(user => {\n    if (user.joinedEventIds && user.joinedEventIds.includes(eventId)) {\n      return {\n        ...user,\n        joinedEventIds: user.joinedEventIds.filter(id => id !== eventId),\n      };\n    }\n    return user;\n  });\n  await writeData<User>(USERS_FILE, users);\n\n  return { success: true, message: \"活动已成功删除。\" };\n}\n\n\nexport async function joinEvent(userId: string, eventId: string, cdKey: string): Promise<{ success: boolean, message: string, event?: Event }> {\n  let events = await readData<Event>(EVENTS_FILE);\n  let users = await readData<User>(USERS_FILE);\n\n  const eventIndex = events.findIndex(e => e.id === eventId);\n  if (eventIndex === -1) return { success: false, message: '活动未找到。' };\n  const event = events[eventIndex];\n\n  const userIndex = users.findIndex(u => u.id === userId);\n  if (userIndex === -1) return { success: false, message: '用户未找到。' };\n  const user = users[userIndex];\n\n  if (event.cdKey.toLowerCase() !== cdKey.toLowerCase()) return { success: false, message: '无效的活动代码。' };\n  if (event.participantLimit && event.participants.length >= event.participantLimit) {\n    return { success: false, message: '活动人数已满。' };\n  }\n  if (event.participants.some(p => p.id === userId)) {\n    return { success: true, message: '您已加入此活动。', event: {...event} };\n  }\n\n  const participant: Participant = {\n    id: user.id,\n    username: user.username,\n    avatarUrl: user.avatarUrl,\n    isCheckedIn: false,\n    op: user.op || 0,\n    password: user.password\n  };\n  event.participants.push(participant);\n\n  if (!user.joinedEventIds) user.joinedEventIds = [];\n  if (!user.joinedEventIds.includes(eventId)) user.joinedEventIds.push(eventId);\n\n  events[eventIndex] = event;\n  users[userIndex] = user;\n\n  await writeData<Event>(EVENTS_FILE, events);\n  await writeData<User>(USERS_FILE, users);\n\n  return { success: true, message: '成功加入活动！', event: {...events[eventIndex]} };\n}\n\nexport async function leaveEvent(userId: string, eventId: string): Promise<{ success: boolean, message: string, event?: Event }> {\n  let events = await readData<Event>(EVENTS_FILE);\n  let users = await readData<User>(USERS_FILE);\n\n  const eventIndex = events.findIndex(e => e.id === eventId);\n  if (eventIndex === -1) return { success: false, message: '活动未找到。' };\n  const event = events[eventIndex];\n\n  const userIndex = users.findIndex(u => u.id === userId);\n  if (userIndex === -1) return { success: false, message: '用户未找到。' };\n  const user = users[userIndex];\n\n  const participantIndexInEvent = event.participants.findIndex(p => p.id === userId);\n\n  if (participantIndexInEvent === -1) {\n    if (user.joinedEventIds && user.joinedEventIds.includes(eventId)) {\n        user.joinedEventIds = user.joinedEventIds.filter(id => id !== eventId);\n        users[userIndex] = user;\n        await writeData<User>(USERS_FILE, users);\n        return { success: true, message: '已从您的活动列表中移除。您并未实际参加此活动。', event: {...events[eventIndex]} };\n    }\n    return { success: false, message: '您当前未加入此活动。' };\n  }\n\n  event.participants.splice(participantIndexInEvent, 1);\n\n  if (user.joinedEventIds) user.joinedEventIds = user.joinedEventIds.filter(id => id !== eventId);\n\n  events[eventIndex] = event;\n  users[userIndex] = user;\n\n  await writeData<Event>(EVENTS_FILE, events);\n  await writeData<User>(USERS_FILE, users);\n\n  return { success: true, message: '成功离开活动。', event: {...events[eventIndex]} };\n}\n\nexport async function checkInUser(userId: string, eventId: string): Promise<{ success: boolean, message: string }> {\n  let events = await readData<Event>(EVENTS_FILE);\n  const eventIndex = events.findIndex(e => e.id === eventId);\n\n  if (eventIndex === -1) return { success: false, message: '活动未找到。' };\n  const event = events[eventIndex];\n\n  const participantIndexInEvent = event.participants.findIndex(p => p.id === userId);\n  if (participantIndexInEvent === -1) return { success: false, message: '您未报名参加此活动。' };\n\n  const participant = event.participants[participantIndexInEvent];\n  if (participant.isCheckedIn) return { success: true, message: '您已签到。' };\n\n  const eventDate = parseISO(event.date);\n  const today = new Date();\n  const isCurrent = eventDate.getFullYear() === today.getFullYear() &&\n                    eventDate.getMonth() === today.getMonth() &&\n                    eventDate.getDate() === today.getDate();\n\n  if (!isCurrent) {\n    return { success: false, message: '此活动的签到尚未开始或已结束。' };\n  }\n\n  participant.isCheckedIn = true;\n  event.participants[participantIndexInEvent] = participant;\n  events[eventIndex] = event;\n\n  await writeData<Event>(EVENTS_FILE, events);\n  return { success: true, message: '签到成功！' };\n}\n\n// --- User Functions ---\nexport async function getUserById(userId: string): Promise<User | undefined> {\n  const users = await readData<User>(USERS_FILE);\n  return users.find(u => u.id === userId);\n}\n\nexport async function getUserByUsername(username: string): Promise<User | undefined> {\n  const users = await readData<User>(USERS_FILE);\n  return users.find(u => u.username.toLowerCase() === username.toLowerCase());\n}\n\nexport async function createUser(userData: Omit<User, 'op' | 'joinedEventIds' | 'avatarUrl'> & { password?: string }): Promise<User> {\n  const users = await readData<User>(USERS_FILE);\n  const existingUser = users.find(u => u.id === userData.id || u.username.toLowerCase() === userData.username.toLowerCase());\n\n  if (existingUser) {\n    console.warn(`尝试创建已存在的用户: ${userData.username} (ID: ${userData.id})。返回现有用户。`);\n    return {...existingUser};\n  }\n\n  const newUser: User = {\n    id: userData.id,\n    username: userData.username,\n    avatarUrl: `https://placehold.co/100x100.png?text=${userData.username.substring(0, 2).toUpperCase()}`,\n    op: 0,\n    joinedEventIds: [],\n    password: userData.password,\n  };\n  users.push(newUser);\n  try {\n    await writeData<User>(USERS_FILE, users);\n  } catch (error) {\n      console.error(\"创建用户时写入数据失败:\", error);\n  }\n  return {...newUser};\n}\n\n// --- Announcement Functions ---\nexport async function getAnnouncements(): Promise<Announcement[]> {\n    return readData<Announcement>(ABOUT_USER_FILE);\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1036, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/lib/namemc.ts"],"sourcesContent":["\n'use server';\n\n/**\n * @fileOverview Mocks a check to NameMC to see if a username is valid.\n */\n\n/**\n * Mocks a check to NameMC to see if a username is valid.\n * In a real application, this would involve an API call to NameMC.\n * @param username The Minecraft username to check.\n * @returns Promise<boolean> True if the username is considered valid, false otherwise.\n */\nexport async function checkNameMC(username: string): Promise<boolean> {\n  console.log(`Pretending to check NameMC for username: ${username}`);\n  // In a real scenario:\n  // try {\n  //   // Example: const response = await fetch(`https://api.namemc.com/profile/${username}/uuid`);\n  //   // return response.ok;\n  // } catch (error) {\n  //   console.error(\"NameMC check failed:\", error);\n  //   return false;\n  // }\n\n  // For testing the \"invalid\" path in the login flow\n  if (username.toLowerCase() === \"invalid_player_for_testing\") {\n    console.log(`Mock: Username \"${username}\" is considered invalid by NameMC.`);\n    return false;\n  }\n\n  // Mock: assume most usernames are valid for now\n  console.log(`Mock: Username \"${username}\" is considered valid by NameMC.`);\n  return true;\n}\n"],"names":[],"mappings":";;;;;;;;AAaO,eAAe,uCAAS,GAAT,YAAY,QAAgB;IAChD,QAAQ,GAAG,CAAC,CAAC,yCAAyC,EAAE,UAAU;IAClE,sBAAsB;IACtB,QAAQ;IACR,iGAAiG;IACjG,2BAA2B;IAC3B,oBAAoB;IACpB,kDAAkD;IAClD,kBAAkB;IAClB,IAAI;IAEJ,mDAAmD;IACnD,IAAI,SAAS,WAAW,OAAO,8BAA8B;QAC3D,QAAQ,GAAG,CAAC,CAAC,gBAAgB,EAAE,SAAS,kCAAkC,CAAC;QAC3E,OAAO;IACT;IAEA,gDAAgD;IAChD,QAAQ,GAAG,CAAC,CAAC,gBAAgB,EAAE,SAAS,gCAAgC,CAAC;IACzE,OAAO;AACT;;;IApBsB;;AAAA,+OAAA","debugId":null}},
    {"offset": {"line": 1074, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/lib/actions.ts"],"sourcesContent":["\n'use server';\n\nimport { cookies } from 'next/headers';\nimport { redirect } from 'next/navigation';\nimport { z } from 'zod';\nimport {\n  createEvent as apiCreateEvent,\n  joinEvent as apiJoinEvent,\n  leaveEvent as apiLeaveEvent,\n  checkInUser as apiCheckInUser,\n  getUserById,\n  getUserByUsername,\n  getEventById,\n  getEvents as apiGetEvents,\n  createUser as apiCreateUser,\n  getEventByCdKey,\n  getAnnouncements as apiGetAnnouncements,\n  deleteEventById as apiDeleteEventById,\n  updateEventById as apiUpdateEventById,\n} from './data';\nimport type { Event, User, Announcement } from './types';\nimport { checkNameMC } from './namemc';\n\nconst MAX_AGE = 60 * 60 * 24 * 30; \n\nconst LoginSchema = z.object({\n  minecraftUsername: z.string().min(1, \"Minecraft 用户名不能为空。\"),\n  password: z.string().min(1, \"密码不能为空。\"),\n});\n\nexport async function login(prevState: any, formData: FormData) {\n  try {\n    const validatedFields = LoginSchema.safeParse(Object.fromEntries(formData.entries()));\n\n    if (!validatedFields.success) {\n      return {\n        message: '输入无效。请检查您的用户名和密码。',\n        errors: validatedFields.error.flatten().fieldErrors,\n        success: false,\n      };\n    }\n\n    const { minecraftUsername, password } = validatedFields.data;\n    let user = await getUserByUsername(minecraftUsername);\n\n    if (user) {\n      if (user.password !== password) {\n        return { message: '密码不正确。', errors: { password: ['密码不正确。'] }, success: false };\n      }\n    } else {\n      const isNameMCValid = await checkNameMC(minecraftUsername);\n      if (!isNameMCValid) {\n        return { message: '此 Minecraft 用户名在 NameMC 上无效或无法验证。', errors: { minecraftUsername: ['此 Minecraft 用户名在 NameMC 上无效或无法验证。'] }, success: false };\n      }\n      try {\n        user = await apiCreateUser({ \n          id: minecraftUsername, \n          username: minecraftUsername,\n          password: password, \n        });\n      } catch (error: any) {\n        console.error(\"登录操作中的用户创建失败 (apiCreateUser):\", error);\n        return { message: `创建用户时出错: ${error.message || '未知错误'}`, errors: {}, success: false };\n      }\n    }\n\n    if (user && user.id) {\n      cookies().set('userId', user.id, {\n        httpOnly: true,\n        secure: process.env.NODE_ENV === 'production',\n        maxAge: MAX_AGE,\n        path: '/',\n        sameSite: 'lax',\n      });\n      // This redirect will be caught by the client and handled.\n      redirect('/dashboard');\n      // return { success: true, message: \"登录成功！即将跳转...\" }; // Not strictly necessary due to redirect\n    } else {\n      return { message: '登录或注册失败，无法找到或创建用户账户。', errors: {}, success: false };\n    }\n  } catch (error: any) {\n     if (error && typeof error === 'object' && 'digest' in error && typeof error.digest === 'string' && error.digest.startsWith('NEXT_REDIRECT')) {\n      // Re-throw NEXT_REDIRECT error to be handled by Next.js\n      throw error;\n    }\n    console.error(\"登录服务器操作发生内部错误:\", error);\n    return { message: '登录服务暂时遇到问题，请稍后再试。', errors: {}, success: false };\n  }\n}\n\n\nexport async function logout() {\n  cookies().delete('userId');\n  redirect('/login');\n}\n\nexport async function getSessionUser(): Promise<User | null> {\n  const userId = cookies().get('userId')?.value;\n  if (!userId) return null;\n  try {\n    const user = await getUserById(userId);\n    return user || null;\n  } catch (error) {\n    console.error(\"获取会话用户失败:\", error);\n    return null;\n  }\n}\n\nconst CreateEventSchema = z.object({\n  name: z.string().min(3, \"活动名称至少需要3个字符。\"),\n  date: z.string().refine((date) => !isNaN(Date.parse(date)), \"无效的日期格式。\"),\n  description: z.string().min(10, \"描述至少需要10个字符。\"),\n  participantLimit: z.preprocess(\n    (val) => (val === \"\" || val === null || val === undefined ? undefined : Number(val)),\n    z.number().int().positive().optional()\n  ),\n  cdKey: z.string().min(4, \"活动代码至少需要4个字符。\").max(20, \"活动代码最多20个字符。\"),\n  imageUrl: z.string().url(\"无效的图片链接。\").optional().or(z.literal('')),\n  userPassword: z.string().min(1, \"您的账户密码不能为空。\")\n});\n\nexport async function createEventAction(prevState: any, formData: FormData) {\n  const rawFormData = Object.fromEntries(formData.entries());\n  const validatedFields = CreateEventSchema.safeParse(rawFormData);\n\n  if (!validatedFields.success) {\n    return {\n      errors: validatedFields.error.flatten().fieldErrors,\n      message: '创建活动失败。请检查所填字段。',\n      success: false,\n    };\n  }\n\n  const user = await getSessionUser();\n  if (!user) {\n    return { message: '需要认证才能创建活动。请先登录。', errors: {}, success: false };\n  }\n  if (user.op !== 1) {\n    return { message: '您没有创建活动的权限。', errors: {}, success: false };\n  }\n\n  if (!user.password || user.password !== validatedFields.data.userPassword) {\n    return {\n      errors: { ...(validatedFields.error?.flatten().fieldErrors || {}), userPassword: ['您的账户密码不正确。'] },\n      message: '创建活动失败。账户密码验证失败。',\n      success: false,\n    };\n  }\n\n  let newEventId: string | undefined;\n  try {\n    const { userPassword, ...eventDataForApi } = validatedFields.data;\n    const newEvent = await apiCreateEvent(\n        eventDataForApi as Omit<Event, 'id' | 'participants' | 'organizerId'>, \n        user.id\n    );\n    newEventId = newEvent.id;\n  } catch (error) {\n    console.error(\"创建活动错误:\", error);\n    return { message: '在服务器上创建活动失败。请稍后重试。', errors: {}, success: false };\n  }\n\n  if (newEventId) {\n    redirect(`/events/${newEventId}`);\n    // return { success: true, message: \"活动创建成功！\" }; // Not strictly necessary due to redirect\n  } else {\n    return { message: '创建活动后未能获取活动ID。', errors: {}, success: false };\n  }\n}\n\nconst UpdateEventSchema = CreateEventSchema.extend({\n  eventId: z.string().min(1, \"Event ID is required.\"),\n});\n\n\nexport async function updateEventAction(prevState: any, formData: FormData) {\n  const rawFormData = Object.fromEntries(formData.entries());\n  const validatedFields = UpdateEventSchema.safeParse(rawFormData);\n\n  if (!validatedFields.success) {\n    return {\n      errors: validatedFields.error.flatten().fieldErrors,\n      message: '更新活动失败。请检查所填字段。',\n      success: false,\n    };\n  }\n\n  const user = await getSessionUser();\n  if (!user) {\n    return { message: '需要认证才能更新活动。请先登录。', errors: {}, success: false };\n  }\n  if (user.op !== 1) {\n    return { message: '您没有更新活动的权限。', errors: {}, success: false };\n  }\n   if (!user.password || user.password !== validatedFields.data.userPassword) {\n    return {\n      errors: { ...(validatedFields.error?.flatten().fieldErrors || {}), userPassword: ['您的账户密码不正确。'] },\n      message: '更新活动失败。账户密码验证失败。',\n      success: false,\n    };\n  }\n\n  try {\n    const { userPassword, eventId, ...eventDataToUpdate } = validatedFields.data;\n    const updatedEvent = await apiUpdateEventById(eventId, eventDataToUpdate as Partial<Omit<Event, 'id' | 'participants' | 'organizerId'>>);\n    if (!updatedEvent) {\n      return { message: '更新活动失败，活动未找到。', errors: { eventId: ['活动未找到。'] }, success: false };\n    }\n  } catch (error) {\n    console.error(\"更新活动错误:\", error);\n    return { message: '在服务器上更新活动失败。请稍后重试。', errors: {}, success: false };\n  }\n  redirect(`/events/${validatedFields.data.eventId}`);\n}\n\n\nexport async function deleteEventAction(eventId: string, userPassword: string): Promise<{ success: boolean, message: string }> {\n  const user = await getSessionUser();\n  if (!user) {\n    return { success: false, message: '需要认证才能删除活动。请先登录。' };\n  }\n  if (user.op !== 1) {\n    return { success: false, message: '您没有删除活动的权限。' };\n  }\n  if (!user.password || user.password !== userPassword) {\n    return { success: false, message: '您的账户密码不正确，无法删除活动。' };\n  }\n\n  try {\n    const result = await apiDeleteEventById(eventId);\n    return result;\n  } catch (error) {\n    console.error(\"删除活动错误:\", error);\n    return { success: false, message: '在服务器上删除活动失败。请稍后重试。' };\n  }\n}\n\n\nexport async function joinEventAction(eventId: string, cdKey: string) {\n  const user = await getSessionUser();\n  if (!user) {\n    return { success: false, message: '您必须登录才能加入活动。' };\n  }\n  try {\n    const result = await apiJoinEvent(user.id, eventId, cdKey);\n    return result;\n  } catch (error) {\n    console.error(\"加入活动错误:\", error);\n    return { success: false, message: '加入活动时发生服务器错误。' };\n  }\n}\n\nexport async function joinEventUsingCdKeyOnlyAction(cdKey: string): Promise<{ success: boolean, message: string, event?: Event }> {\n  const user = await getSessionUser();\n  if (!user) {\n    return { success: false, message: '您必须登录才能加入活动。' };\n  }\n\n  if (!cdKey || cdKey.trim() === '') {\n    return { success: false, message: '请输入有效的活动代码。' };\n  }\n\n  const eventToJoin = await getEventByCdKey(cdKey);\n  if (!eventToJoin) {\n    return { success: false, message: '具有此活动代码的活动未找到。' };\n  }\n\n  try {\n    const result = await apiJoinEvent(user.id, eventToJoin.id, cdKey); \n    return result;\n  } catch (error) {\n    console.error(\"使用活动代码加入活动错误:\", error);\n    return { success: false, message: '使用活动代码加入活动时发生服务器错误。' };\n  }\n}\n\n\nexport async function leaveEventAction(eventId: string) {\n  const user = await getSessionUser();\n  if (!user) {\n    return { success: false, message: '您必须登录才能离开活动。' };\n  }\n  try {\n    const result = await apiLeaveEvent(user.id, eventId);\n    return result;\n  } catch (error) {\n    console.error(\"离开活动错误:\", error);\n    return { success: false, message: '离开活动时发生服务器错误。' };\n  }\n}\n\nexport async function checkInAction(eventId: string) {\n  const user = await getSessionUser();\n  if (!user) {\n    return { success: false, message: '您必须登录才能签到。' };\n  }\n  try {\n    const result = await apiCheckInUser(user.id, eventId);\n    return result;\n  } catch (error) {\n    console.error(\"签到错误:\", error);\n    return { success: false, message: '签到过程中发生服务器错误。' };\n  }\n}\n\nexport async function getEventDetailsAction(eventId: string): Promise<Event | null> {\n  try {\n    const event = await getEventById(eventId);\n    return event || null;\n  } catch (error) {\n    console.error(\"获取活动详情错误 (action):\", error);\n    return null;\n  }\n}\n\nexport async function getEventsAction(): Promise<Event[]> {\n  try {\n    return await apiGetEvents();\n  } catch (error) {\n    console.error(\"获取所有活动失败 (action):\", error);\n    return [];\n  }\n}\n\nexport async function getUserProfile(userId: string): Promise<{ user: User; joinedEvents: Event[] } | null> {\n  const user = await getUserById(userId);\n  if (!user) {\n    console.warn(`用户个人资料未找到: ${userId}`);\n    return null;\n  }\n\n  const allEvents = await apiGetEvents(); \n  \n  const joinedEventIds = user.joinedEventIds || [];\n  const joinedEventsRaw = allEvents.filter(event => joinedEventIds.includes(event.id));\n\n  const participantUserIdsInJoinedEvents = new Set<string>();\n  joinedEventsRaw.forEach(event => {\n    (event.participants || []).forEach(p => participantUserIdsInJoinedEvents.add(p.id));\n  });\n\n  const allParticipantUsersData: User[] = [];\n   for (const pId of Array.from(participantUserIdsInJoinedEvents)) {\n    const pUser = await getUserById(pId); \n    if (pUser) {\n      allParticipantUsersData.push(pUser);\n    }\n  }\n  \n  const enrichedJoinedEvents = joinedEventsRaw.map(ev => {\n    const mainEventParticipantsEnriched = (ev.participants || []).map(p => {\n         const fullPUser = allParticipantUsersData.find(up => up.id === p.id);\n         return {\n            id: p.id,\n            username: fullPUser?.username || p.username || '未知用户',\n            avatarUrl: fullPUser?.avatarUrl || p.avatarUrl || `https://placehold.co/40x40.png?text=${(p.username || '??').substring(0,2)}`,\n            isCheckedIn: p.isCheckedIn === true, \n            op: fullPUser?.op ?? p.op ?? 0,\n            password: fullPUser?.password // Ensure password is part of participant if needed by UserAvatar or other components\n         };\n    });\n    return { ...ev, participants: mainEventParticipantsEnriched };\n  });\n\n  return {\n    user: {...user}, \n    joinedEvents: enrichedJoinedEvents.map(e => ({...e})) \n  };\n}\n\nexport async function getAnnouncementsAction(): Promise<Announcement[]> {\n  try {\n    return await apiGetAnnouncements();\n  } catch (error) {\n    console.error(\"获取公告失败 (action):\", error);\n    return [];\n  }\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1571, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/badge.tsx"],"sourcesContent":["import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst badgeVariants = cva(\n  \"inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2\",\n  {\n    variants: {\n      variant: {\n        default:\n          \"border-transparent bg-primary text-primary-foreground hover:bg-primary/80\",\n        secondary:\n          \"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80\",\n        destructive:\n          \"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80\",\n        outline: \"text-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nexport interface BadgeProps\n  extends React.HTMLAttributes<HTMLDivElement>,\n    VariantProps<typeof badgeVariants> {}\n\nfunction Badge({ className, variant, ...props }: BadgeProps) {\n  return (\n    <div className={cn(badgeVariants({ variant }), className)} {...props} />\n  )\n}\n\nexport { Badge, badgeVariants }\n"],"names":[],"mappings":";;;;;AACA;AAEA;;;;AAEA,MAAM,gBAAgB,CAAA,GAAA,gKAAA,CAAA,MAAG,AAAD,EACtB,0KACA;IACE,UAAU;QACR,SAAS;YACP,SACE;YACF,WACE;YACF,aACE;YACF,SAAS;QACX;IACF;IACA,iBAAiB;QACf,SAAS;IACX;AACF;AAOF,SAAS,MAAM,EAAE,SAAS,EAAE,OAAO,EAAE,GAAG,OAAmB;IACzD,qBACE,8OAAC;QAAI,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,cAAc;YAAE;QAAQ,IAAI;QAAa,GAAG,KAAK;;;;;;AAExE","debugId":null}},
    {"offset": {"line": 1613, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/header.tsx"],"sourcesContent":["\nimport LoadingLink from '@/components/loading-link';\nimport { Gem, LogIn, UserCircle, PlusCircle, LogOut as LogOutIcon, LayoutDashboard } from 'lucide-react';\nimport { Button } from '@/components/ui/button';\nimport { Avatar, AvatarFallback, AvatarImage } from '@/components/ui/avatar';\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuTrigger,\n} from \"@/components/ui/dropdown-menu\";\nimport { getSessionUser } from '@/lib/actions';\nimport { Badge } from '@/components/ui/badge';\n\n\nexport default async function Header() {\n  const user = await getSessionUser();\n\n  return (\n    <header className=\"sticky top-0 z-50 w-full border-b bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60\">\n      <div className=\"container flex h-16 items-center justify-between\">\n        <div className=\"flex items-center\">\n          <LoadingLink href=\"/\" className=\"mr-6 flex items-center space-x-2\">\n            <Gem className=\"h-6 w-6 text-primary\" />\n            <span className=\"font-bold sm:inline-block text-lg\">\n              MineVent\n            </span>\n            <Badge variant=\"outline\" className=\"ml-2 border-orange-500 text-orange-600 dark:border-orange-400 dark:text-orange-400 text-xs px-1.5 py-0.5\">Beta</Badge>\n          </LoadingLink>\n          <nav className=\"flex items-center space-x-4 lg:space-x-6\">\n            <Button variant=\"ghost\" asChild>\n              <LoadingLink href=\"/\">活动</LoadingLink>\n            </Button>\n            {user && (\n               <Button variant=\"ghost\" asChild>\n                  <LoadingLink href=\"/dashboard\">仪表盘</LoadingLink>\n              </Button>\n            )}\n          </nav>\n        </div>\n        \n        <div className=\"flex items-center space-x-4\">\n          {user ? (\n            <DropdownMenu>\n              <DropdownMenuTrigger asChild>\n                <Button variant=\"ghost\" className=\"relative h-8 w-8 rounded-full\">\n                  <Avatar className=\"h-8 w-8\">\n                    <AvatarImage src={user.avatarUrl || `https://avatar.vercel.sh/${user.username}.png?text=${user.username.substring(0,1)}`} alt={user.username} data-ai-hint=\"minecraft avatar\" />\n                    <AvatarFallback>{user.username.substring(0, 2).toUpperCase()}</AvatarFallback>\n                  </Avatar>\n                </Button>\n              </DropdownMenuTrigger>\n              <DropdownMenuContent className=\"w-56\" align=\"end\" forceMount>\n                <DropdownMenuLabel className=\"font-normal\">\n                  <div className=\"flex flex-col space-y-1\">\n                    <p className=\"text-sm font-medium leading-none\">{user.username}</p>\n                    <p className=\"text-xs leading-none text-muted-foreground\">\n                      {user.id} \n                    </p>\n                  </div>\n                </DropdownMenuLabel>\n                <DropdownMenuSeparator />\n                <DropdownMenuItem asChild>\n                  <LoadingLink href=\"/dashboard\">\n                    <LayoutDashboard className=\"mr-2 h-4 w-4\" />\n                    <span>我的仪表盘</span>\n                  </LoadingLink>\n                </DropdownMenuItem>\n                {user.op === 1 && (\n                  <DropdownMenuItem asChild>\n                    <LoadingLink href=\"/admin/create-event\">\n                      <PlusCircle className=\"mr-2 h-4 w-4\" />\n                      <span>创建活动</span>\n                    </LoadingLink>\n                  </DropdownMenuItem>\n                )}\n                <DropdownMenuSeparator />\n                <DropdownMenuItem asChild>\n                  <form action=\"/api/auth/logout\" method=\"POST\" className=\"w-full\">\n                     <button type=\"submit\" className=\"w-full text-left flex items-center p-2 hover:bg-accent rounded-sm text-sm relative cursor-default select-none items-center gap-2 outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\">\n                        <LogOutIcon className=\"mr-2 h-4 w-4\" />\n                        <span>退出登录</span>\n                      </button>\n                  </form>\n                </DropdownMenuItem>\n              </DropdownMenuContent>\n            </DropdownMenu>\n          ) : (\n            <Button asChild>\n              <LoadingLink href=\"/login\">\n                <LogIn className=\"mr-2 h-4 w-4\" /> 登录\n              </LoadingLink>\n            </Button>\n          )}\n        </div>\n      </div>\n    </header>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1976, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/footer.tsx"],"sourcesContent":["\nexport default function Footer() {\n  return (\n    <footer className=\"border-t py-8 bg-secondary/30\">\n      <div className=\"container mx-auto px-4 text-center text-muted-foreground\">\n        <p>&copy; {new Date().getFullYear()} MineVent. 保留所有权利。</p>\n        <p className=\"text-sm mt-1\">有dream_pep开发与设计，基于项目MineVent Work</p>\n        <p className=\"text-xs mt-2 text-orange-600 dark:text-orange-400\">本系统正在测试，发现错误请及时反馈。</p>\n      </div>\n    </footer>\n  );\n}\n"],"names":[],"mappings":";;;;;AACe,SAAS;IACtB,qBACE,8OAAC;QAAO,WAAU;kBAChB,cAAA,8OAAC;YAAI,WAAU;;8BACb,8OAAC;;wBAAE;wBAAQ,IAAI,OAAO,WAAW;wBAAG;;;;;;;8BACpC,8OAAC;oBAAE,WAAU;8BAAe;;;;;;8BAC5B,8OAAC;oBAAE,WAAU;8BAAoD;;;;;;;;;;;;;;;;;AAIzE","debugId":null}},
    {"offset": {"line": 2032, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/app/%28auth%29/layout.tsx"],"sourcesContent":["\nimport Header from '@/components/header';\nimport Footer from '@/components/footer';\n\nexport default function AuthLayout({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  return (\n    <div className=\"flex flex-col min-h-screen\">\n      <Header />\n      <main className=\"flex-grow flex flex-col items-center justify-center bg-gradient-to-br from-background to-secondary/20 py-6\">\n        {children}\n      </main>\n      <Footer />\n    </div>\n  )\n}\n"],"names":[],"mappings":";;;;AACA;AACA;;;;AAEe,SAAS,WAAW,EACjC,QAAQ,EAGT;IACC,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC,4HAAA,CAAA,UAAM;;;;;0BACP,8OAAC;gBAAK,WAAU;0BACb;;;;;;0BAEH,8OAAC,4HAAA,CAAA,UAAM;;;;;;;;;;;AAGb","debugId":null}}]
}