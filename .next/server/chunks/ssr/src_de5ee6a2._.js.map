{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/card.tsx"],"sourcesContent":["import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Card = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"rounded-lg border bg-card text-card-foreground shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nCard.displayName = \"Card\"\n\nconst CardHeader = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex flex-col space-y-1.5 p-6\", className)}\n    {...props}\n  />\n))\nCardHeader.displayName = \"CardHeader\"\n\nconst CardTitle = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"text-2xl font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nCardTitle.displayName = \"CardTitle\"\n\nconst CardDescription = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nCardDescription.displayName = \"CardDescription\"\n\nconst CardContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"p-6 pt-0\", className)} {...props} />\n))\nCardContent.displayName = \"CardContent\"\n\nconst CardFooter = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex items-center p-6 pt-0\", className)}\n    {...props}\n  />\n))\nCardFooter.displayName = \"CardFooter\"\n\nexport { Card, CardHeader, CardFooter, CardTitle, CardDescription, CardContent }\n"],"names":[],"mappings":";;;;;;;;;AAAA;AAEA;;;;AAEA,MAAM,qBAAO,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAG1B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EACV,4DACA;QAED,GAAG,KAAK;;;;;;AAGb,KAAK,WAAW,GAAG;AAEnB,MAAM,2BAAa,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAGhC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGb,WAAW,WAAW,GAAG;AAEzB,MAAM,0BAAY,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAG/B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EACV,sDACA;QAED,GAAG,KAAK;;;;;;AAGb,UAAU,WAAW,GAAG;AAExB,MAAM,gCAAkB,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAGrC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGb,gBAAgB,WAAW,GAAG;AAE9B,MAAM,4BAAc,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAGjC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QAAI,KAAK;QAAK,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,YAAY;QAAa,GAAG,KAAK;;;;;;AAEhE,YAAY,WAAW,GAAG;AAE1B,MAAM,2BAAa,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAGhC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,8BAA8B;QAC3C,GAAG,KAAK;;;;;;AAGb,WAAW,WAAW,GAAG","debugId":null}},
    {"offset": {"line": 88, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/label.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst labelVariants = cva(\n  \"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n)\n\nconst Label = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root> &\n    VariantProps<typeof labelVariants>\n>(({ className, ...props }, ref) => (\n  <LabelPrimitive.Root\n    ref={ref}\n    className={cn(labelVariants(), className)}\n    {...props}\n  />\n))\nLabel.displayName = LabelPrimitive.Root.displayName\n\nexport { Label }\n"],"names":[],"mappings":";;;;AAEA;AACA;AACA;AAEA;AANA;;;;;;AAQA,MAAM,gBAAgB,CAAA,GAAA,gKAAA,CAAA,MAAG,AAAD,EACtB;AAGF,MAAM,sBAAQ,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAI3B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC,iKAAA,CAAA,OAAmB;QAClB,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,iBAAiB;QAC9B,GAAG,KAAK;;;;;;AAGb,MAAM,WAAW,GAAG,iKAAA,CAAA,OAAmB,CAAC,WAAW","debugId":null}},
    {"offset": {"line": 120, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/tabs.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as TabsPrimitive from \"@radix-ui/react-tabs\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Tabs = TabsPrimitive.Root\n\nconst TabsList = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.List\n    ref={ref}\n    className={cn(\n      \"inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsList.displayName = TabsPrimitive.List.displayName\n\nconst TabsTrigger = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsTrigger.displayName = TabsPrimitive.Trigger.displayName\n\nconst TabsContent = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsContent.displayName = TabsPrimitive.Content.displayName\n\nexport { Tabs, TabsList, TabsTrigger, TabsContent }\n"],"names":[],"mappings":";;;;;;;AAEA;AACA;AAEA;AALA;;;;;AAOA,MAAM,OAAO,gKAAA,CAAA,OAAkB;AAE/B,MAAM,yBAAW,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAG9B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC,gKAAA,CAAA,OAAkB;QACjB,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EACV,8FACA;QAED,GAAG,KAAK;;;;;;AAGb,SAAS,WAAW,GAAG,gKAAA,CAAA,OAAkB,CAAC,WAAW;AAErD,MAAM,4BAAc,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAGjC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC,gKAAA,CAAA,UAAqB;QACpB,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EACV,uYACA;QAED,GAAG,KAAK;;;;;;AAGb,YAAY,WAAW,GAAG,gKAAA,CAAA,UAAqB,CAAC,WAAW;AAE3D,MAAM,4BAAc,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAGjC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC,gKAAA,CAAA,UAAqB;QACpB,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EACV,mIACA;QAED,GAAG,KAAK;;;;;;AAGb,YAAY,WAAW,GAAG,gKAAA,CAAA,UAAqB,CAAC,WAAW","debugId":null}},
    {"offset": {"line": 173, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/app/%28auth%29/login/page.tsx"],"sourcesContent":["\n'use client';\n\nimport LoadingLink from '@/components/loading-link';\nimport { Button } from '@/components/ui/button';\nimport { Card, CardContent, CardDescription, CardFooter, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Input } from '@/components/ui/input';\nimport { Label } from '@/components/ui/label';\nimport { Eye, UserPlus, AlertCircle, Loader2, LogOut as LogOutIcon, LayoutDashboard, UserCheck } from 'lucide-react';\nimport { useRouter } from 'next/navigation';\nimport React, { useEffect, useState, useActionState } from 'react';\nimport Script from 'next/script';\nimport { authenticateUserAction, getSessionUser, type AuthFormState } from '@/lib/actions';\nimport { useLoading } from '@/contexts/loading-context';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\n\n// Geetest v4 result type\ninterface GeetestCaptchaResult {\n  lot_number: string;\n  captcha_output: string;\n  pass_token: string;\n  gen_time: string;\n}\n\nexport default function LoginPage() {\n  const router = useRouter();\n  const [isDebugMode, setIsDebugMode] = useState(false);\n  const [isLoggedIn, setIsLoggedIn] = useState<boolean | null>(null);\n  const [sessionUsername, setSessionUsername] = useState<string>('');\n  const { startLoading, stopLoading } = useLoading();\n  const [authMode, setAuthMode] = useState<'login' | 'register'>('login');\n\n  const [sdkReady, setSdkReady] = useState(false);\n  const [captchaObj, setCaptchaObj] = useState<any>(null);\n  const [captchaResult, setCaptchaResult] = useState<GeetestCaptchaResult | null>(null);\n  const [isCaptchaVerified, setIsCaptchaVerified] = useState(false);\n\n\n  const initialState: AuthFormState = { message: null, errors: {}, success: false };\n  const [state, formAction, isActionPending] = useActionState(\n    async (prevState: AuthFormState, formData: FormData) => {\n      console.log(\"Form submitted with mode:\", formData.get('authMode'));\n      startLoading();\n      let result;\n      try {\n        result = await authenticateUserAction(prevState, formData);\n\n        if (result && (result.errors || (result.message && !result.success))) {\n          // Error occurred, no redirect, so stop loading\n          stopLoading();\n          // If Geetest failed, reset captcha so user has to do it again\n          if (result.errors?.captcha) {\n            setIsCaptchaVerified(false);\n            setCaptchaResult(null);\n            captchaObj?.reset();\n          }\n        }\n        // If successful, redirection is handled by the action or a subsequent effect in LoadingProgressBar.\n        return result;\n      } catch (error: any) {\n        if (error && typeof error === 'object' && 'digest' in error && typeof error.digest === 'string' && error.digest.startsWith('NEXT_REDIRECT')) {\n          // This is a redirect error, re-throw it to let Next.js handle it\n          // stopLoading will be called by LoadingProgressBar on route change\n          throw error;\n        }\n        console.error(\"Login/Register action failed on client:\", error);\n        stopLoading(); // Generic error, stop loading\n        return { message: '认证时发生意外错误。', errors: {form: ['认证时发生意外错误。']}, success: false };\n      }\n    },\n    initialState\n  );\n  \n  useEffect(() => {\n    const geetestCaptchaId = process.env.NEXT_PUBLIC_GEETEST_CAPTCHA_ID;\n    if (sdkReady && geetestCaptchaId && typeof window !== 'undefined' && (window as any).initGeetest4) {\n      console.log(\"Attempting to init Geetest with ID:\", geetestCaptchaId);\n      (window as any).initGeetest4({\n        captchaId: geetestCaptchaId,\n        product: 'bind', // Use 'bind' to render a button in the container\n        // lang: 'zho', // Optional: set language\n      }, (captcha: any) => {\n        setCaptchaObj(captcha);\n        try {\n          captcha.appendTo('#captcha-container');\n          console.log(\"Geetest widget appended to #captcha-container\");\n        } catch (e) {\n          console.error(\"Error appending Geetest widget:\", e);\n        }\n        captcha.onSuccess(() => {\n          const result = captcha.getValidate();\n          console.log(\"Geetest validation success (client):\", result);\n          setCaptchaResult(result);\n          setIsCaptchaVerified(true);\n        });\n        captcha.onError((error: any) => {\n          console.error(\"Geetest error (client):\", error);\n          setIsCaptchaVerified(false);\n          setCaptchaResult(null);\n           // Potentially show a toast or message to the user here\n        });\n      });\n    } else if (sdkReady && !geetestCaptchaId) {\n        console.warn(\"Geetest Captcha ID (NEXT_PUBLIC_GEETEST_CAPTCHA_ID) is not defined on the client.\");\n    }\n    // Cleanup on component unmount or if captchaObj changes\n    return () => {\n        captchaObj?.destroy?.();\n    };\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [sdkReady, authMode]); // Re-init Geetest if authMode changes, to reset its state visually if needed\n\n  useEffect(() => {\n    setIsDebugMode(process.env.NEXT_PUBLIC_DEBUG_MODE === 'true');\n\n    async function checkLoginStatus() {\n      try {\n        const user = await getSessionUser();\n        if (user) {\n          setIsLoggedIn(true);\n          setSessionUsername(user.username);\n        } else {\n          setIsLoggedIn(false);\n        }\n      } catch (e) {\n         console.error(\"登录页面检查登录状态时出错:\", e);\n         setIsLoggedIn(false);\n      }\n    }\n    checkLoginStatus();\n  }, []);\n\n  const handleTabChange = (newMode: 'login' | 'register') => {\n    setAuthMode(newMode);\n    // Reset Geetest and form state when tabs change\n    setIsCaptchaVerified(false);\n    setCaptchaResult(null);\n    if (captchaObj) {\n      captchaObj.reset();\n    }\n    // Reset useActionState errors - this is tricky. A common way is to change the form key or re-init useActionState.\n    // For simplicity, we'll rely on the fact that `state` will be re-evaluated by the action.\n    // If a more forceful reset of displayed errors is needed, that would require more complex state management.\n  };\n\n\n  const handleDebugLogin = () => {\n    startLoading();\n    router.push('/dashboard?debug_user_id=dream_pep_id');\n  };\n\n  const handleLogout = async (event: React.FormEvent<HTMLFormElement>) => {\n    event.preventDefault();\n    startLoading();\n    event.currentTarget.submit();\n  };\n\n\n  if (isLoggedIn === null) {\n    return (\n      <div className=\"flex justify-center items-center min-h-[calc(100vh-15rem)]\">\n        <Loader2 className=\"h-12 w-12 animate-spin text-primary\" />\n      </div>\n    );\n  }\n\n  const LoginPageContentWrapper = ({ children }: { children: React.ReactNode }) => (\n    <div className=\"flex flex-col items-center justify-center flex-grow w-full bg-gradient-to-br from-background to-secondary/20 py-6\">\n      {children}\n    </div>\n  );\n\n\n  if (isLoggedIn) {\n    return (\n      <LoginPageContentWrapper>\n        <Card className=\"w-full max-w-md shadow-xl text-center\">\n          <CardHeader>\n            <CardTitle className=\"text-2xl font-bold\">您已登录</CardTitle>\n            <CardDescription>您当前以 {sessionUsername} 的身份登录。</CardDescription>\n          </CardHeader>\n          <CardContent>\n            <p>您想退出登录吗？或者前往仪表盘？</p>\n          </CardContent>\n          <CardFooter className=\"flex flex-col gap-3\">\n            <form action=\"/api/auth/logout\" method=\"POST\" onSubmit={handleLogout} className=\"w-full\">\n              <Button type=\"submit\" variant=\"destructive\" className=\"w-full\">\n                <LogOutIcon className=\"mr-2 h-5 w-5\" /> 退出登录\n              </Button>\n            </form>\n            <Button variant=\"outline\" onClick={() => { startLoading(); router.push('/dashboard'); }} className=\"w-full\">\n              <LayoutDashboard className=\"mr-2 h-5 w-5\" /> 前往仪表盘\n            </Button>\n          </CardFooter>\n        </Card>\n      </LoginPageContentWrapper>\n    );\n  }\n\n  return (\n    <LoginPageContentWrapper>\n      <Script\n        src=\"https://static.geetest.com/v4/gt4.js\"\n        strategy=\"afterInteractive\"\n        onLoad={() => {\n          console.log(\"Geetest SDK script loaded.\");\n          setSdkReady(true);\n        }}\n        onError={(e) => {\n          console.error(\"Failed to load Geetest SDK:\", e);\n        }}\n      />\n      <div className=\"w-full max-w-md\">\n        <Card className=\"shadow-xl\">\n          <Tabs value={authMode} onValueChange={(value) => handleTabChange(value as 'login' | 'register')} className=\"w-full\">\n            <div className=\"flex justify-center pt-4 mb-4\">\n              <TabsList>\n                <TabsTrigger value=\"login\">登录</TabsTrigger>\n                <TabsTrigger value=\"register\">注册</TabsTrigger>\n              </TabsList>\n            </div>\n             {/* Geetest Container - Single instance outside TabsContent but inside Tabs */}\n            <div className=\"px-6 pb-4\"> {/* Added padding for Geetest container */}\n              <div id=\"captcha-container\" className=\"w-full h-12 flex items-center justify-center text-muted-foreground text-sm mb-2\">\n                {sdkReady && process.env.NEXT_PUBLIC_GEETEST_CAPTCHA_ID ? '请完成人机验证' : '正在加载人机验证...'}\n                {!process.env.NEXT_PUBLIC_GEETEST_CAPTCHA_ID && sdkReady && <span className=\"text-destructive text-xs\">Geetest CAPTCHA ID 未配置!</span>}\n              </div>\n              {state.errors?.captcha && <p className=\"text-sm text-destructive text-center\">{state.errors.captcha[0]}</p>}\n            </div>\n\n            <TabsContent value=\"login\">\n              <CardHeader className=\"text-center pt-0 pb-2\"> {/* Adjusted padding */}\n                <CardTitle className=\"text-2xl font-bold\">登录 VRCub 活动中心</CardTitle>\n                <CardDescription>\n                  输入您的 Minecraft 用户名和密码进行登录。\n                </CardDescription>\n              </CardHeader>\n              <form action={formAction}>\n                <CardContent className=\"space-y-4\">\n                  <input type=\"hidden\" name=\"authMode\" value=\"login\" />\n                   {captchaResult && (\n                    <>\n                      <input type=\"hidden\" name=\"lot_number\" value={captchaResult.lot_number} />\n                      <input type=\"hidden\" name=\"captcha_output\" value={captchaResult.captcha_output} />\n                      <input type=\"hidden\" name=\"pass_token\" value={captchaResult.pass_token} />\n                      <input type=\"hidden\" name=\"gen_time\" value={captchaResult.gen_time} />\n                    </>\n                  )}\n                  <div className=\"space-y-2\">\n                    <Label htmlFor=\"loginMinecraftUsername\">Minecraft 用户名</Label>\n                    <Input\n                      id=\"loginMinecraftUsername\"\n                      name=\"minecraftUsername\"\n                      type=\"text\"\n                      placeholder=\"例如：Steve\"\n                      required\n                      aria-describedby=\"login-username-error\"\n                    />\n                    {state.errors?.minecraftUsername && authMode === 'login' && <p id=\"login-username-error\" className=\"text-sm text-destructive\">{state.errors.minecraftUsername[0]}</p>}\n                  </div>\n\n                  <div className=\"space-y-2\">\n                    <Label htmlFor=\"loginPassword\">密码</Label>\n                    <Input\n                      id=\"loginPassword\"\n                      name=\"password\"\n                      type=\"password\"\n                      placeholder=\"输入您的密码\"\n                      required\n                      aria-describedby=\"login-password-error\"\n                    />\n                    {state.errors?.password && authMode === 'login' && <p id=\"login-password-error\" className=\"text-sm text-destructive\">{state.errors.password[0]}</p>}\n                  </div>\n                  <p className=\"text-xs text-muted-foreground pt-1\">\n                      重要提示：此为原型系统，密码将以明文存储。请勿使用真实密码。\n                  </p>\n\n                  {state?.message && authMode === 'login' && !state.success && (!state.errors || Object.keys(state.errors).length === 0 || state.errors.form) && (\n                    <p className=\"text-sm text-destructive flex items-center\"><AlertCircle className=\"w-4 h-4 mr-1\"/> {state.message || state.errors?.form?.[0]}</p>\n                  )}\n\n                  <Button type=\"submit\" className=\"w-full\" disabled={isActionPending || !isCaptchaVerified}>\n                     {isActionPending ? <Loader2 className=\"mr-2 h-5 w-5 animate-spin\" /> : <UserCheck className=\"mr-2 h-5 w-5\"/>}\n                    登录\n                  </Button>\n                </CardContent>\n              </form>\n            </TabsContent>\n            <TabsContent value=\"register\">\n              <CardHeader className=\"text-center pt-0 pb-2\"> {/* Adjusted padding */}\n                <CardTitle className=\"text-2xl font-bold\">注册 VRCub 活动中心账户</CardTitle>\n                <CardDescription>\n                  使用您的 Minecraft 用户名创建新账户。\n                </CardDescription>\n              </CardHeader>\n              <form action={formAction}>\n                <CardContent className=\"space-y-4\">\n                  <input type=\"hidden\" name=\"authMode\" value=\"register\" />\n                  {captchaResult && (\n                    <>\n                      <input type=\"hidden\" name=\"lot_number\" value={captchaResult.lot_number} />\n                      <input type=\"hidden\" name=\"captcha_output\" value={captchaResult.captcha_output} />\n                      <input type=\"hidden\" name=\"pass_token\" value={captchaResult.pass_token} />\n                      <input type=\"hidden\" name=\"gen_time\" value={captchaResult.gen_time} />\n                    </>\n                  )}\n                  <div className=\"space-y-2\">\n                    <Label htmlFor=\"registerMinecraftUsername\">Minecraft 用户名</Label>\n                    <Input\n                      id=\"registerMinecraftUsername\"\n                      name=\"minecraftUsername\"\n                      type=\"text\"\n                      placeholder=\"3-16位字母、数字或下划线\"\n                      required\n                      aria-describedby=\"register-username-error\"\n                    />\n                    {state.errors?.minecraftUsername && authMode === 'register' && <p id=\"register-username-error\" className=\"text-sm text-destructive\">{state.errors.minecraftUsername[0]}</p>}\n                  </div>\n\n                  <div className=\"space-y-2\">\n                    <Label htmlFor=\"registerPassword\">密码</Label>\n                    <Input\n                      id=\"registerPassword\"\n                      name=\"password\"\n                      type=\"password\"\n                      placeholder=\"至少6位字符\"\n                      required\n                      aria-describedby=\"register-password-error\"\n                    />\n                    {state.errors?.password && authMode === 'register' && <p id=\"register-password-error\" className=\"text-sm text-destructive\">{state.errors.password[0]}</p>}\n                  </div>\n                   <div className=\"space-y-2\">\n                    <Label htmlFor=\"confirmPassword\">确认密码</Label>\n                    <Input\n                      id=\"confirmPassword\"\n                      name=\"confirmPassword\"\n                      type=\"password\"\n                      placeholder=\"再次输入密码\"\n                      required\n                      aria-describedby=\"confirm-password-error\"\n                    />\n                    {state.errors?.confirmPassword && authMode === 'register' && <p id=\"confirm-password-error\" className=\"text-sm text-destructive\">{state.errors.confirmPassword[0]}</p>}\n                  </div>\n                  <p className=\"text-xs text-muted-foreground pt-1\">\n                      重要提示：此为原型系统，密码将以明文存储。请勿使用真实密码。\n                  </p>\n                  \n                  {state?.message && authMode === 'register' && !state.success && (!state.errors || Object.keys(state.errors).length === 0 || state.errors.form) && (\n                     <p className=\"text-sm text-destructive flex items-center\"><AlertCircle className=\"w-4 h-4 mr-1\"/> {state.message || state.errors?.form?.[0]}</p>\n                  )}\n\n                  <Button type=\"submit\" className=\"w-full\" disabled={isActionPending || !isCaptchaVerified}>\n                    {isActionPending ? <Loader2 className=\"mr-2 h-5 w-5 animate-spin\" /> : <UserPlus className=\"mr-2 h-5 w-5\" />}\n                    创建账户\n                  </Button>\n                </CardContent>\n              </form>\n            </TabsContent>\n          </Tabs>\n          <CardFooter className=\"flex flex-col gap-4 pt-6\">\n            {isDebugMode && (\n              <Button\n                type=\"button\"\n                variant=\"secondary\"\n                className=\"w-full border-dashed border-primary/50 hover:border-primary\"\n                onClick={handleDebugLogin}\n              >\n                <Eye className=\"mr-2 h-5 w-5\" />\n                调试：以 dream_pep 身份查看仪表盘\n              </Button>\n            )}\n            <p className=\"text-sm text-muted-foreground\">\n              遇到问题？请联系<LoadingLink href=\"#\" className=\"font-medium text-primary hover:underline\">管理员</LoadingLink>。\n            </p>\n          </CardFooter>\n        </Card>\n      </div>\n    </LoginPageContentWrapper>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}